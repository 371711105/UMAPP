@section Scripts {
    <script>
        var tokenKey = 'accessToken';

        $(document).ready(function () {
            var registerForm = $("#registerForm");
            var loginForm = $("#loginForm");
            //注册
            $(".btn-register").click(function () {
                var data = {
                    Email: registerForm.find(".txt-email").val(),
                    Password: registerForm.find(".txt-password").val(),
                    ConfirmPassword: registerForm.find(".txt-confirm-password").val()
                };
                $.ajax({
                    url: "/api/Account/Register",
                    data: JSON.stringify(data),
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    success: function (data) {
                        layer.alert("注册成功！");
                    },
                    error: function (xhr, error) {
                        layer.alert(JSON.stringify(xhr));
                    }
                });
            });
            //登入
            $(".btn-login").click(function () {
                var loginData = {
                    grant_type: 'password',
                    username: loginForm.find(".txt-email").val(),
                    password: loginForm.find(".txt-password").val()
                };
                $.ajax({
                    url: "/Token",
                    data: loginData,
                    type: "POST",
                    success: function (data) {
                        layer.alert("登入成功！");
                        sessionStorage.setItem(tokenKey, data.access_token);
                    },
                    error: function (xhr, error) {
                        layer.alert(JSON.stringify(xhr));
                    }
                });
            });
            //退出
            $(".btn-logout").click(function () {
                var token = sessionStorage.getItem(tokenKey);
                var headers = {};
                if (token) {
                    headers.Authorization = 'Bearer ' + token;
                }
                $.ajax({
                    url: "/api/Account/Logout",
                    data: {},
                    type: "POST",
                    headers: headers,
                    success: function (data) {
                        sessionStorage.removeItem(tokenKey);
                        layer.alert("退出成功！");
                    },
                    error: function (xhr, error) {
                        layer.alert(JSON.stringify(xhr));
                    }
                });
            });
            //UserInfo
            $(".btn-user-info").click(function () {
                $("#userInfoString").html("");
                var token = sessionStorage.getItem(tokenKey);
                var headers = {};
                if (token) {
                    headers.Authorization = 'Bearer ' + token;
                }
                $.ajax({
                    url: "/api/Account/UserInfo",
                    data: {},
                    type: "GET",
                    headers: headers,
                    success: function (data) {
                        $("#userInfoString").html(JSON.stringify(data));
                    },
                    error: function (xhr, error) {
                        layer.alert(JSON.stringify(xhr));
                    }
                });
            });
        });
    </script>
}
@*<div class="jumbotron">
        <h1>ASP.NET</h1>
        <p class="lead">ASP.NET is a free web framework for building great Web sites and Web applications using HTML, CSS, and JavaScript.</p>
        <p><a href="http://asp.net" class="btn btn-primary btn-lg">Learn more &raquo;</a></p>
    </div>*@
<div class="row">
    <div class="col-sm-4">
        <form id="registerForm">
            <h3>Register</h3>
            <div class="form-group">
                <label>Email</label>
                <input class="form-control txt-email" type="text" />
            </div>
            <div class="form-group">
                <label>Password</label>
                <input class="form-control txt-password" type="password" />
            </div>
            <div class="form-group">
                <label>Confirm Password</label>
                <input class="form-control txt-confirm-password" type="password" />
            </div>
            <div class="form-group">
                <button type="button" class="btn btn-default btn-register">Register</button>
            </div>
        </form>
    </div>
    <div class="col-sm-4">
        <h3>Log In</h3>
        <form id="loginForm">
            <div class="form-group">
                <label>Email</label>
                <input class="form-control txt-email" type="text" />
            </div>
            <div class="form-group">
                <label>Password</label>
                <input class="form-control txt-password" type="password" />
            </div>
            <div class="form-group">
                <button type="button" class="btn btn-default btn-login">Log In</button>
                <button type="button" class="btn btn-default btn-logout">Log Out</button>
            </div>
        </form>
    </div>
    <div class="col-sm-4">
        <h3>userInfo</h3>
        <form id="userInfoForm">
            <div class="form-group">
                <p id="userInfoString">

                </p>
            </div>
            <div class="form-group">
                <button type="button" class="btn btn-default btn-user-info">userInfo</button>
            </div>
        </form>
    </div>
</div>
@*<div class="row">
        <div class="col-md-4">
            <h2>Getting started</h2>
            <p>
                ASP.NET Web API is a framework that makes it easy to build HTTP services that reach
                a broad range of clients, including browsers and mobile devices. ASP.NET Web API
                is an ideal platform for building RESTful applications on the .NET Framework.
            </p>
            <p><a class="btn btn-default" href="http://go.microsoft.com/fwlink/?LinkId=301870">Learn more &raquo;</a></p>
        </div>
        <div class="col-md-4">
            <h2>Get more libraries</h2>
            <p>NuGet is a free Visual Studio extension that makes it easy to add, remove, and update libraries and tools in Visual Studio projects.</p>
            <p><a class="btn btn-default" href="http://go.microsoft.com/fwlink/?LinkId=301871">Learn more &raquo;</a></p>
        </div>
        <div class="col-md-4">
            <h2>Web Hosting</h2>
            <p>You can easily find a web hosting company that offers the right mix of features and price for your applications.</p>
            <p><a class="btn btn-default" href="http://go.microsoft.com/fwlink/?LinkId=301872">Learn more &raquo;</a></p>
        </div>
    </div>*@
